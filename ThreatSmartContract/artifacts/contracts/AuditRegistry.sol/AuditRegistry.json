{
  "_format": "hh-sol-artifact-1",
  "contractName": "AuditRegistry",
  "sourceName": "contracts/AuditRegistry.sol",
  "abi": [
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "initialOwner",
          "type": "address"
        }
      ],
      "stateMutability": "nonpayable",
      "type": "constructor"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "owner",
          "type": "address"
        }
      ],
      "name": "OwnableInvalidOwner",
      "type": "error"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "account",
          "type": "address"
        }
      ],
      "name": "OwnableUnauthorizedAccount",
      "type": "error"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "address",
          "name": "previousOwner",
          "type": "address"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "newOwner",
          "type": "address"
        }
      ],
      "name": "OwnershipTransferred",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "reportId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "contractAudited",
          "type": "address"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "auditor",
          "type": "address"
        },
        {
          "indexed": false,
          "internalType": "enum AuditRegistry.ThreatLevel",
          "name": "level",
          "type": "uint8"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "score",
          "type": "uint256"
        },
        {
          "indexed": false,
          "internalType": "string",
          "name": "cid",
          "type": "string"
        },
        {
          "indexed": false,
          "internalType": "uint8",
          "name": "version",
          "type": "uint8"
        }
      ],
      "name": "ReportSubmitted",
      "type": "event"
    },
    {
      "inputs": [],
      "name": "getLastTenReports",
      "outputs": [
        {
          "internalType": "uint256[]",
          "name": "",
          "type": "uint256[]"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "contractAddress",
          "type": "address"
        }
      ],
      "name": "getLatestReport",
      "outputs": [
        {
          "components": [
            {
              "internalType": "address",
              "name": "contractAudited",
              "type": "address"
            },
            {
              "internalType": "enum AuditRegistry.ThreatLevel",
              "name": "threatLevel",
              "type": "uint8"
            },
            {
              "internalType": "uint256",
              "name": "threatScore",
              "type": "uint256"
            },
            {
              "internalType": "string",
              "name": "ipfsCid",
              "type": "string"
            },
            {
              "internalType": "uint256",
              "name": "timestamp",
              "type": "uint256"
            },
            {
              "internalType": "uint8",
              "name": "auditVersion",
              "type": "uint8"
            }
          ],
          "internalType": "struct AuditRegistry.AuditReport",
          "name": "",
          "type": "tuple"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "auditedContract",
          "type": "address"
        }
      ],
      "name": "getReportsByContract",
      "outputs": [
        {
          "internalType": "uint256[]",
          "name": "",
          "type": "uint256[]"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "contractAddress",
          "type": "address"
        }
      ],
      "name": "isContractAudited",
      "outputs": [
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "owner",
      "outputs": [
        {
          "internalType": "address",
          "name": "",
          "type": "address"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "renounceOwnership",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "reportCount",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "name": "reports",
      "outputs": [
        {
          "internalType": "address",
          "name": "contractAudited",
          "type": "address"
        },
        {
          "internalType": "enum AuditRegistry.ThreatLevel",
          "name": "threatLevel",
          "type": "uint8"
        },
        {
          "internalType": "uint256",
          "name": "threatScore",
          "type": "uint256"
        },
        {
          "internalType": "string",
          "name": "ipfsCid",
          "type": "string"
        },
        {
          "internalType": "uint256",
          "name": "timestamp",
          "type": "uint256"
        },
        {
          "internalType": "uint8",
          "name": "auditVersion",
          "type": "uint8"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "",
          "type": "address"
        },
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "name": "reportsByContract",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "_contractAudited",
          "type": "address"
        },
        {
          "internalType": "enum AuditRegistry.ThreatLevel",
          "name": "_level",
          "type": "uint8"
        },
        {
          "internalType": "uint256",
          "name": "_threatScore",
          "type": "uint256"
        },
        {
          "internalType": "string",
          "name": "_cid",
          "type": "string"
        },
        {
          "internalType": "uint8",
          "name": "_auditVersion",
          "type": "uint8"
        }
      ],
      "name": "submitReport",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "newOwner",
          "type": "address"
        }
      ],
      "name": "transferOwnership",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    }
  ],
  "bytecode": "0x608060405234801561001057600080fd5b5060405161103638038061103683398101604081905261002f916100be565b806001600160a01b03811661005e57604051631e4fbdf760e01b81526000600482015260240160405180910390fd5b6100678161006e565b50506100ee565b600080546001600160a01b038381166001600160a01b0319831681178455604051919092169283917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e09190a35050565b6000602082840312156100d057600080fd5b81516001600160a01b03811681146100e757600080fd5b9392505050565b610f39806100fd6000396000f3fe608060405234801561001057600080fd5b50600436106100a95760003560e01c80639cd85e21116100715780639cd85e211461013f578063a0438b8d14610152578063c942adf714610172578063d1270b0114610197578063e7c99bae146101aa578063f2fde38b146101bd57600080fd5b8063108d171a146100ae578063185c6f84146100ee5780632ebda6de14610105578063715018a61461011a5780638da5cb5b14610124575b600080fd5b6100d96100bc366004610a09565b6001600160a01b0316600090815260036020526040902054151590565b60405190151581526020015b60405180910390f35b6100f760015481565b6040519081526020016100e5565b61010d6101d0565b6040516100e59190610a2b565b61012261029c565b005b6000546040516001600160a01b0390911681526020016100e5565b61012261014d366004610a95565b6102b0565b610165610160366004610a09565b610535565b6040516100e59190610c0e565b610185610180366004610c7c565b610772565b6040516100e596959493929190610c95565b6100f76101a5366004610ce6565b610844565b61010d6101b8366004610a09565b610875565b6101226101cb366004610a09565b610932565b60015460609060008190036101f357505060408051600081526020810190915290565b6000600a82116102035781610206565b600a5b905060008167ffffffffffffffff81111561022357610223610a6e565b60405190808252806020026020018201604052801561024c578160200160208202803683370190505b50905060005b8281101561029457806102658486610d26565b61026f9190610d3f565b82828151811061028157610281610d52565b6020908102919091010152600101610252565b509392505050565b6102a4610970565b6102ae600061099d565b565b6102b8610970565b6001600160a01b03851661030e5760405162461bcd60e51b8152602060048201526018602482015277496e76616c696420636f6e7472616374206164647265737360401b60448201526064015b60405180910390fd5b600082511161035f5760405162461bcd60e51b815260206004820152601860248201527f49504653204349442063616e6e6f7420626520656d70747900000000000000006044820152606401610305565b6103e88311156103b15760405162461bcd60e51b815260206004820152601c60248201527f5468726561742073636f72652065786365656473206d6178696d756d000000006044820152606401610305565b6040518060c00160405280866001600160a01b031681526020018560048111156103dd576103dd610b90565b81526020808201869052604080830186905242606084015260ff851660809093019290925260015460009081526002825291909120825181546001600160a01b039091166001600160a01b031982168117835592840151919283916001600160a81b03191617600160a01b83600481111561045a5761045a610b90565b0217905550604082015160018201556060820151600282019061047d9082610df1565b50608082015160038281019190915560a0909201516004909101805460ff191660ff9092169190911790556001600160a01b03861660008181526020928352604080822060018054825480830184559285529590932001939093555491513392907fa49b48b5fa18119860fc0cf18a9bfc62ad032b7c1df394893db98624fe22700490610511908990899089908990610eb0565b60405180910390a46001805490600061052983610eea565b91905055505050505050565b6040805160c081018252600080825260208083018290528284018290526060808401526080830182905260a083018290526001600160a01b03851682526003815283822080548551818402810184019096528086529394929390918301828280156105bf57602002820191906000526020600020905b8154815260200190600101908083116105ab575b5050505050905060008151116106285760405162461bcd60e51b815260206004820152602860248201527f4e6f206175646974207265706f72747320666f756e6420666f7220746869732060448201526718dbdb9d1c9858dd60c21b6064820152608401610305565b600081600183516106399190610d26565b8151811061064957610649610d52565b602090810291909101810151600081815260028352604090819020815160c0810190925280546001600160a01b03811683529294509092909190830190600160a01b900460ff1660048111156106a1576106a1610b90565b60048111156106b2576106b2610b90565b8152602001600182015481526020016002820180546106d090610d68565b80601f01602080910402602001604051908101604052809291908181526020018280546106fc90610d68565b80156107495780601f1061071e57610100808354040283529160200191610749565b820191906000526020600020905b81548152906001019060200180831161072c57829003601f168201915b50505091835250506003820154602082015260049091015460ff16604090910152949350505050565b60026020819052600091825260409091208054600182015492820180546001600160a01b03831694600160a01b90930460ff169391906107b190610d68565b80601f01602080910402602001604051908101604052809291908181526020018280546107dd90610d68565b801561082a5780601f106107ff5761010080835404028352916020019161082a565b820191906000526020600020905b81548152906001019060200180831161080d57829003601f168201915b50505050600383015460049093015491929160ff16905086565b6003602052816000526040600020818154811061086057600080fd5b90600052602060002001600091509150505481565b60606001600160a01b0382166108c85760405162461bcd60e51b8152602060048201526018602482015277496e76616c696420636f6e7472616374206164647265737360401b6044820152606401610305565b6001600160a01b0382166000908152600360209081526040918290208054835181840281018401909452808452909183018282801561092657602002820191906000526020600020905b815481526020019060010190808311610912575b50505050509050919050565b61093a610970565b6001600160a01b03811661096457604051631e4fbdf760e01b815260006004820152602401610305565b61096d8161099d565b50565b6000546001600160a01b031633146102ae5760405163118cdaa760e01b8152336004820152602401610305565b600080546001600160a01b038381166001600160a01b0319831681178455604051919092169283917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e09190a35050565b80356001600160a01b0381168114610a0457600080fd5b919050565b600060208284031215610a1b57600080fd5b610a24826109ed565b9392505050565b602080825282518282018190526000918401906040840190835b81811015610a63578351835260209384019390920191600101610a45565b509095945050505050565b634e487b7160e01b600052604160045260246000fd5b803560ff81168114610a0457600080fd5b600080600080600060a08688031215610aad57600080fd5b610ab6866109ed565b9450602086013560058110610aca57600080fd5b935060408601359250606086013567ffffffffffffffff811115610aed57600080fd5b8601601f81018813610afe57600080fd5b803567ffffffffffffffff811115610b1857610b18610a6e565b604051601f8201601f19908116603f0116810167ffffffffffffffff81118282101715610b4757610b47610a6e565b6040528181528282016020018a1015610b5f57600080fd5b81602084016020830137600060208383010152809450505050610b8460808701610a84565b90509295509295909350565b634e487b7160e01b600052602160045260246000fd5b60058110610bc457634e487b7160e01b600052602160045260246000fd5b9052565b6000815180845260005b81811015610bee57602081850181015186830182015201610bd2565b506000602082860101526020601f19601f83011685010191505092915050565b602080825282516001600160a01b031682820152820151600090610c356040840182610ba6565b5060408301516060830152606083015160c06080840152610c5960e0840182610bc8565b9050608084015160a084015260ff60a08501511660c08401528091505092915050565b600060208284031215610c8e57600080fd5b5035919050565b6001600160a01b0387168152610cae6020820187610ba6565b84604082015260c060608201526000610cca60c0830186610bc8565b905083608083015260ff831660a0830152979650505050505050565b60008060408385031215610cf957600080fd5b610d02836109ed565b946020939093013593505050565b634e487b7160e01b600052601160045260246000fd5b81810381811115610d3957610d39610d10565b92915050565b80820180821115610d3957610d39610d10565b634e487b7160e01b600052603260045260246000fd5b600181811c90821680610d7c57607f821691505b602082108103610d9c57634e487b7160e01b600052602260045260246000fd5b50919050565b601f821115610dec57806000526020600020601f840160051c81016020851015610dc95750805b601f840160051c820191505b81811015610de95760008155600101610dd5565b50505b505050565b815167ffffffffffffffff811115610e0b57610e0b610a6e565b610e1f81610e198454610d68565b84610da2565b6020601f821160018114610e535760008315610e3b5750848201515b600019600385901b1c1916600184901b178455610de9565b600084815260208120601f198516915b82811015610e835787850151825560209485019460019092019101610e63565b5084821015610ea15786840151600019600387901b60f8161c191681555b50505050600190811b01905550565b610eba8186610ba6565b836020820152608060408201526000610ed66080830185610bc8565b905060ff8316606083015295945050505050565b600060018201610efc57610efc610d10565b506001019056fea264697066735822122075fa14bae0fb1d771643c107944cf12fcf3a4db94626885517d5eff37dae75b164736f6c634300081c0033",
  "deployedBytecode": "0x608060405234801561001057600080fd5b50600436106100a95760003560e01c80639cd85e21116100715780639cd85e211461013f578063a0438b8d14610152578063c942adf714610172578063d1270b0114610197578063e7c99bae146101aa578063f2fde38b146101bd57600080fd5b8063108d171a146100ae578063185c6f84146100ee5780632ebda6de14610105578063715018a61461011a5780638da5cb5b14610124575b600080fd5b6100d96100bc366004610a09565b6001600160a01b0316600090815260036020526040902054151590565b60405190151581526020015b60405180910390f35b6100f760015481565b6040519081526020016100e5565b61010d6101d0565b6040516100e59190610a2b565b61012261029c565b005b6000546040516001600160a01b0390911681526020016100e5565b61012261014d366004610a95565b6102b0565b610165610160366004610a09565b610535565b6040516100e59190610c0e565b610185610180366004610c7c565b610772565b6040516100e596959493929190610c95565b6100f76101a5366004610ce6565b610844565b61010d6101b8366004610a09565b610875565b6101226101cb366004610a09565b610932565b60015460609060008190036101f357505060408051600081526020810190915290565b6000600a82116102035781610206565b600a5b905060008167ffffffffffffffff81111561022357610223610a6e565b60405190808252806020026020018201604052801561024c578160200160208202803683370190505b50905060005b8281101561029457806102658486610d26565b61026f9190610d3f565b82828151811061028157610281610d52565b6020908102919091010152600101610252565b509392505050565b6102a4610970565b6102ae600061099d565b565b6102b8610970565b6001600160a01b03851661030e5760405162461bcd60e51b8152602060048201526018602482015277496e76616c696420636f6e7472616374206164647265737360401b60448201526064015b60405180910390fd5b600082511161035f5760405162461bcd60e51b815260206004820152601860248201527f49504653204349442063616e6e6f7420626520656d70747900000000000000006044820152606401610305565b6103e88311156103b15760405162461bcd60e51b815260206004820152601c60248201527f5468726561742073636f72652065786365656473206d6178696d756d000000006044820152606401610305565b6040518060c00160405280866001600160a01b031681526020018560048111156103dd576103dd610b90565b81526020808201869052604080830186905242606084015260ff851660809093019290925260015460009081526002825291909120825181546001600160a01b039091166001600160a01b031982168117835592840151919283916001600160a81b03191617600160a01b83600481111561045a5761045a610b90565b0217905550604082015160018201556060820151600282019061047d9082610df1565b50608082015160038281019190915560a0909201516004909101805460ff191660ff9092169190911790556001600160a01b03861660008181526020928352604080822060018054825480830184559285529590932001939093555491513392907fa49b48b5fa18119860fc0cf18a9bfc62ad032b7c1df394893db98624fe22700490610511908990899089908990610eb0565b60405180910390a46001805490600061052983610eea565b91905055505050505050565b6040805160c081018252600080825260208083018290528284018290526060808401526080830182905260a083018290526001600160a01b03851682526003815283822080548551818402810184019096528086529394929390918301828280156105bf57602002820191906000526020600020905b8154815260200190600101908083116105ab575b5050505050905060008151116106285760405162461bcd60e51b815260206004820152602860248201527f4e6f206175646974207265706f72747320666f756e6420666f7220746869732060448201526718dbdb9d1c9858dd60c21b6064820152608401610305565b600081600183516106399190610d26565b8151811061064957610649610d52565b602090810291909101810151600081815260028352604090819020815160c0810190925280546001600160a01b03811683529294509092909190830190600160a01b900460ff1660048111156106a1576106a1610b90565b60048111156106b2576106b2610b90565b8152602001600182015481526020016002820180546106d090610d68565b80601f01602080910402602001604051908101604052809291908181526020018280546106fc90610d68565b80156107495780601f1061071e57610100808354040283529160200191610749565b820191906000526020600020905b81548152906001019060200180831161072c57829003601f168201915b50505091835250506003820154602082015260049091015460ff16604090910152949350505050565b60026020819052600091825260409091208054600182015492820180546001600160a01b03831694600160a01b90930460ff169391906107b190610d68565b80601f01602080910402602001604051908101604052809291908181526020018280546107dd90610d68565b801561082a5780601f106107ff5761010080835404028352916020019161082a565b820191906000526020600020905b81548152906001019060200180831161080d57829003601f168201915b50505050600383015460049093015491929160ff16905086565b6003602052816000526040600020818154811061086057600080fd5b90600052602060002001600091509150505481565b60606001600160a01b0382166108c85760405162461bcd60e51b8152602060048201526018602482015277496e76616c696420636f6e7472616374206164647265737360401b6044820152606401610305565b6001600160a01b0382166000908152600360209081526040918290208054835181840281018401909452808452909183018282801561092657602002820191906000526020600020905b815481526020019060010190808311610912575b50505050509050919050565b61093a610970565b6001600160a01b03811661096457604051631e4fbdf760e01b815260006004820152602401610305565b61096d8161099d565b50565b6000546001600160a01b031633146102ae5760405163118cdaa760e01b8152336004820152602401610305565b600080546001600160a01b038381166001600160a01b0319831681178455604051919092169283917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e09190a35050565b80356001600160a01b0381168114610a0457600080fd5b919050565b600060208284031215610a1b57600080fd5b610a24826109ed565b9392505050565b602080825282518282018190526000918401906040840190835b81811015610a63578351835260209384019390920191600101610a45565b509095945050505050565b634e487b7160e01b600052604160045260246000fd5b803560ff81168114610a0457600080fd5b600080600080600060a08688031215610aad57600080fd5b610ab6866109ed565b9450602086013560058110610aca57600080fd5b935060408601359250606086013567ffffffffffffffff811115610aed57600080fd5b8601601f81018813610afe57600080fd5b803567ffffffffffffffff811115610b1857610b18610a6e565b604051601f8201601f19908116603f0116810167ffffffffffffffff81118282101715610b4757610b47610a6e565b6040528181528282016020018a1015610b5f57600080fd5b81602084016020830137600060208383010152809450505050610b8460808701610a84565b90509295509295909350565b634e487b7160e01b600052602160045260246000fd5b60058110610bc457634e487b7160e01b600052602160045260246000fd5b9052565b6000815180845260005b81811015610bee57602081850181015186830182015201610bd2565b506000602082860101526020601f19601f83011685010191505092915050565b602080825282516001600160a01b031682820152820151600090610c356040840182610ba6565b5060408301516060830152606083015160c06080840152610c5960e0840182610bc8565b9050608084015160a084015260ff60a08501511660c08401528091505092915050565b600060208284031215610c8e57600080fd5b5035919050565b6001600160a01b0387168152610cae6020820187610ba6565b84604082015260c060608201526000610cca60c0830186610bc8565b905083608083015260ff831660a0830152979650505050505050565b60008060408385031215610cf957600080fd5b610d02836109ed565b946020939093013593505050565b634e487b7160e01b600052601160045260246000fd5b81810381811115610d3957610d39610d10565b92915050565b80820180821115610d3957610d39610d10565b634e487b7160e01b600052603260045260246000fd5b600181811c90821680610d7c57607f821691505b602082108103610d9c57634e487b7160e01b600052602260045260246000fd5b50919050565b601f821115610dec57806000526020600020601f840160051c81016020851015610dc95750805b601f840160051c820191505b81811015610de95760008155600101610dd5565b50505b505050565b815167ffffffffffffffff811115610e0b57610e0b610a6e565b610e1f81610e198454610d68565b84610da2565b6020601f821160018114610e535760008315610e3b5750848201515b600019600385901b1c1916600184901b178455610de9565b600084815260208120601f198516915b82811015610e835787850151825560209485019460019092019101610e63565b5084821015610ea15786840151600019600387901b60f8161c191681555b50505050600190811b01905550565b610eba8186610ba6565b836020820152608060408201526000610ed66080830185610bc8565b905060ff8316606083015295945050505050565b600060018201610efc57610efc610d10565b506001019056fea264697066735822122075fa14bae0fb1d771643c107944cf12fcf3a4db94626885517d5eff37dae75b164736f6c634300081c0033",
  "linkReferences": {},
  "deployedLinkReferences": {}
}
